<Window x:Class="HCWpfFramework.Views.FrameworkMainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:hc="clr-namespace:HCWpfFramework.Controls"
xmlns:models="clr-namespace:HCWpfFramework.Models"
xmlns:converters="clr-namespace:HCWpfFramework.Converters"
Title="{Binding Title}" 
Height="600" Width="900"
WindowStartupLocation="CenterScreen"
Style="{StaticResource ThemedWindowStyle}">
    
    <Window.Resources>
        <converters:LayoutVisibilityConverter x:Key="LayoutVisibilityConverter" />
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="{DynamicResource MenuBackgroundBrush}" Foreground="{DynamicResource MenuTextBrush}">
            <!-- Framework Menu -->
            <MenuItem Header="File">
                <MenuItem Header="New" Command="{Binding NewCommand}"/>
                <MenuItem Header="Open" Command="{Binding OpenCommand}"/>
                <Separator/>
                <MenuItem Header="Exit" Command="{Binding ExitCommand}"/>
            </MenuItem>
            
            <MenuItem Header="Layout">
                <MenuItem Header="Single Pane" Command="{Binding ChangeLayoutCommand}" CommandParameter="Single"/>
                <MenuItem Header="Top/Bottom Split" Command="{Binding ChangeLayoutCommand}" CommandParameter="TopBottom"/>
                <MenuItem Header="Three Pane" Command="{Binding ChangeLayoutCommand}" CommandParameter="ThreePane"/>
                <MenuItem Header="Four Pane" Command="{Binding ChangeLayoutCommand}" CommandParameter="FourPane"/>
                <Separator/>
                <MenuItem Header="Reset Layout" Command="{Binding ResetLayoutCommand}"/>
                <MenuItem Header="Save Layout" Command="{Binding SaveLayoutCommand}"/>
                <MenuItem Header="Load Layout" Command="{Binding LoadLayoutCommand}"/>
            </MenuItem>
            
            <MenuItem Header="Debug">
                <MenuItem Header="Test Framework" Command="{Binding TestLayoutCommand}"/>
                <Separator/>
                <MenuItem Header="Force Light Theme" Command="{Binding ForceLightThemeCommand}"/>
                <MenuItem Header="Force Dark Theme" Command="{Binding ForceDarkThemeCommand}"/>
                <MenuItem Header="Sync Theme Selector" Command="{Binding SyncThemeSelectorCommand}"/>
                <MenuItem Header="Refresh Theme Status" Command="{Binding RefreshThemeStatusCommand}"/>
            </MenuItem>

            <!-- Theme Selector in Menu -->
            <MenuItem>
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Margin="8,0">
                        <TextBlock Text="Theme: " VerticalAlignment="Center" Margin="0,0,5,0" Foreground="{DynamicResource MenuTextBrush}"/>
                        <hc:ThemeSelector ThemeService="{Binding GetThemeService}"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <!-- Extensible menu area - can be customized by inheriting applications -->
            <ContentPresenter x:Name="CustomMenuArea" Content="{Binding CustomMenuContent}" />
        </Menu>
        
        <!-- Main Content Area with Dynamic Layout -->
        <Grid Grid.Row="1" x:Name="MainContentArea">
            <!-- Single Pane Layout -->
            <hc:DockingPanel x:Name="SinglePaneLayout"
                             PanelTitle="Main Content (SINGLE)"
                             DockableWindows="{Binding CenterPanelWindows}"
                             WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                             WindowCloseRequested="OnDockingPanel_WindowCloseRequested"
                             Background="LightBlue"
                             Visibility="{Binding CurrentLayoutType, Converter={StaticResource LayoutVisibilityConverter}, ConverterParameter=Single}" />
            
            <!-- Top/Bottom Layout -->
            <Grid x:Name="TopBottomLayout" 
                  Background="LightGreen" 
                  Visibility="{Binding CurrentLayoutType, Converter={StaticResource LayoutVisibilityConverter}, ConverterParameter=TopBottom}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" MinHeight="200"/>
                    <RowDefinition Height="5"/>
                    <RowDefinition Height="200" MinHeight="100"/>
                </Grid.RowDefinitions>
                
                <hc:DockingPanel Grid.Row="0"
                                 PanelTitle="Main Content"
                                 DockableWindows="{Binding CenterPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                
                <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                
                <hc:DockingPanel Grid.Row="2"
                                 PanelTitle="Output"
                                 DockableWindows="{Binding BottomPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
            </Grid>
            
            <!-- Three Pane Layout (Left, Center, Right) -->
            <Grid x:Name="ThreePaneLayout" 
                  Background="LightYellow" 
                  Visibility="{Binding CurrentLayoutType, Converter={StaticResource LayoutVisibilityConverter}, ConverterParameter=ThreePane}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250" MinWidth="150"/>
                    <ColumnDefinition Width="5"/>
                    <ColumnDefinition Width="*" MinWidth="300"/>
                    <ColumnDefinition Width="5"/>
                    <ColumnDefinition Width="250" MinWidth="150"/>
                </Grid.ColumnDefinitions>
                
                <hc:DockingPanel Grid.Column="0"
                                 PanelTitle="Explorer"
                                 DockableWindows="{Binding LeftPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                
                <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                
                <hc:DockingPanel Grid.Column="2"
                                 PanelTitle="Main Content"
                                 DockableWindows="{Binding CenterPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                
                <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                
                <hc:DockingPanel Grid.Column="4"
                                 PanelTitle="Properties"
                                 DockableWindows="{Binding RightPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
            </Grid>
            
            <!-- Four Pane Layout (Left, Center/Bottom, Right) -->
            <Grid x:Name="FourPaneLayout" 
                  Background="LightCoral" 
                  Visibility="{Binding CurrentLayoutType, Converter={StaticResource LayoutVisibilityConverter}, ConverterParameter=FourPane}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="250" MinWidth="150"/>
                    <ColumnDefinition Width="5"/>
                    <ColumnDefinition Width="*" MinWidth="300"/>
                    <ColumnDefinition Width="5"/>
                    <ColumnDefinition Width="250" MinWidth="150"/>
                </Grid.ColumnDefinitions>
                
                <hc:DockingPanel Grid.Column="0"
                                 PanelTitle="Explorer"
                                 DockableWindows="{Binding LeftPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                
                <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                
                <!-- Center panel with top/bottom split -->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" MinHeight="200"/>
                        <RowDefinition Height="5"/>
                        <RowDefinition Height="200" MinHeight="100"/>
                    </Grid.RowDefinitions>
                    
                    <hc:DockingPanel Grid.Row="0"
                                     PanelTitle="Main Content"
                                     DockableWindows="{Binding CenterPanelWindows}"
                                     WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                     WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                    
                    <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                    
                    <hc:DockingPanel Grid.Row="2"
                                     PanelTitle="Output"
                                     DockableWindows="{Binding BottomPanelWindows}"
                                     WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                     WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
                </Grid>
                
                <GridSplitter Grid.Column="3" Width="5" HorizontalAlignment="Stretch" Style="{StaticResource ThemedGridSplitterStyle}"/>
                
                <hc:DockingPanel Grid.Column="4"
                                 PanelTitle="Properties"
                                 DockableWindows="{Binding RightPanelWindows}"
                                 WindowFloatRequested="OnDockingPanel_WindowFloatRequested"
                                 WindowCloseRequested="OnDockingPanel_WindowCloseRequested"/>
            </Grid>
        </Grid>
        
        <!-- Status Bar -->
        <StatusBar Grid.Row="2" Style="{StaticResource ThemedStatusBarStyle}">
            <StatusBarItem>
                <TextBlock Text="{Binding StatusMessage}" Style="{StaticResource ThemedSecondaryTextBlockStyle}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Layout: " Style="{StaticResource ThemedSecondaryTextBlockStyle}"/>
                    <TextBlock Text="{Binding CurrentLayoutType}" Style="{StaticResource ThemedTextBlockStyle}" FontWeight="SemiBold" Foreground="Red"/>
                    <Rectangle Width="15" Height="1" Fill="Transparent"/>
                    <TextBlock Text="Theme: " Style="{StaticResource ThemedSecondaryTextBlockStyle}"/>
                    <TextBlock Text="{Binding CurrentThemeName}" Style="{StaticResource ThemedTextBlockStyle}" FontWeight="SemiBold" Foreground="Green"/>
                    <!-- Additional content area for application-specific status -->
                    <ContentPresenter Content="{Binding CustomStatusContent}" Margin="15,0,0,0"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>